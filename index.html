<html lang="en" class="scroll-smooth" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IP Grabber & Ping Test - Glassmorphism UI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    /* Glassmorphism container */
    .glass {
      background: rgba(255, 255, 255, 0.15);
      border-radius: 1rem;
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.18);
    }
    /* Custom scrollbar for speed test logs */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    ::-webkit-scrollbar-track {
      background: transparent;
    }
    ::-webkit-scrollbar-thumb {
      background-color: rgba(118, 75, 162, 0.6);
      border-radius: 10px;
      border: 2px solid transparent;
      background-clip: content-box;
    }
  </style>
</head>
<body class="flex flex-col min-h-screen justify-between items-center p-6" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
  <main class="glass max-w-3xl w-full p-8 mt-12 mb-12" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
    <h1 class="text-4xl font-semibold text-white mb-8 text-center drop-shadow-lg" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
      IP Grabber & Ping Test
    </h1>

    <!-- IP Info Section -->
    <section
      id="ip-info"
      class="glass p-6 rounded-xl mb-10 shadow-lg border border-white/30"
      ondragstart="return false" onselectstart="return false" oncontextmenu="return false"
    >
      <h2 class="text-2xl font-semibold text-white mb-6 text-center drop-shadow-md" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
        Your IP Information
      </h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 text-white text-lg" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
        <div>
          <p class="font-semibold mb-1" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">IP Address:</p>
          <div class="flex items-center space-x-3" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
            <p id="ip-address" class="break-all select-text" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">Loading...</p>
            <button
              id="copy-ip-btn"
              aria-label="Copy IP Address"
              class="text-purple-300 hover:text-purple-100 transition"
              title="Copy IP Address"
              ondragstart="return false" onselectstart="return false" oncontextmenu="return false"
            >
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
        <div>
          <p class="font-semibold mb-1" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">City:</p>
          <p id="ip-city" class="break-all select-text" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">Loading...</p>
        </div>
        <div>
          <p class="font-semibold mb-1" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">Region:</p>
          <p id="ip-region" class="break-all select-text" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">Loading...</p>
        </div>
        <div>
          <p class="font-semibold mb-1" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">Country:</p>
          <p id="ip-country" class="break-all select-text" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">Loading...</p>
        </div>
        <div>
          <p class="font-semibold mb-1" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">ISP:</p>
          <p id="ip-isp" class="break-all select-text" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">Loading...</p>
        </div>
        <div>
          <p class="font-semibold mb-1" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">VPN / Proxy Detected:</p>
          <p
            id="ip-vpn"
            class="break-all select-text text-yellow-300 font-semibold"
            ondragstart="return false" onselectstart="return false" oncontextmenu="return false"
          >
            Checking...
          </p>
        </div>
      </div>
    </section>

    <!-- Ping Test Section -->
    <section
      id="ping-test"
      class="glass p-6 rounded-xl shadow-lg border border-white/30"
      ondragstart="return false" onselectstart="return false" oncontextmenu="return false"
    >
      <h2 class="text-2xl font-semibold text-white mb-6 text-center drop-shadow-md" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
        Ping Test
      </h2>
      <div class="flex flex-col items-center space-y-6" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
        <button
          id="start-ping-test"
          class="bg-purple-600 hover:bg-purple-700 active:bg-purple-800 text-white font-semibold py-3 px-8 rounded-lg shadow-lg transition flex items-center space-x-3"
          ondragstart="return false" onselectstart="return false" oncontextmenu="return false"
        >
          <i class="fas fa-tachometer-alt"></i>
          <span>Start Ping Test</span>
        </button>

        <div
          id="ping-results"
          class="w-full max-w-xl text-white text-center space-y-4"
          ondragstart="return false" onselectstart="return false" oncontextmenu="return false"
        >
          <div ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
            <p class="text-lg font-semibold" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">Ping:</p>
            <p id="ping" class="text-3xl font-bold" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">- ms</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="text-white text-center mb-6 select-none" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
    Developed by Deepak Dev
  </footer>

  <script>
    // Disable drag, select, and context menu globally as extra fallback
    document.addEventListener('dragstart', e => e.preventDefault());
    document.addEventListener('selectstart', e => e.preventDefault());
    document.addEventListener('contextmenu', e => e.preventDefault());

    // Utility: Copy text to clipboard with fallback
    async function copyToClipboard(text) {
      try {
        if (navigator.clipboard) {
          await navigator.clipboard.writeText(text);
          alert('Copied to clipboard: ' + text);
        } else {
          // Fallback for older browsers
          const textarea = document.createElement('textarea');
          textarea.value = text;
          textarea.style.position = 'fixed';
          textarea.style.top = '-9999px';
          document.body.appendChild(textarea);
          textarea.focus();
          textarea.select();
          document.execCommand('copy');
          document.body.removeChild(textarea);
          alert('Copied to clipboard: ' + text);
        }
      } catch (err) {
        alert('Failed to copy: ' + err);
      }
    }

    // Fetch IP info and VPN/Proxy detection from ipapi.co
    async function fetchIPInfo() {
      try {
        const res = await fetch('https://ipapi.co/json/');
        if (!res.ok) throw new Error('Failed to fetch IP info');
        const data = await res.json();
        return data;
      } catch (e) {
        return null;
      }
    }

    // Helper: measure ping latency (ms)
    async function measurePing(url, attempts = 5) {
      let total = 0;
      let count = 0;
      for (let i = 0; i < attempts; i++) {
        const start = performance.now();
        try {
          await fetch(url, { method: 'HEAD', cache: 'no-cache' });
          const end = performance.now();
          total += end - start;
          count++;
        } catch {
          // ignore errors
        }
        await new Promise((r) => setTimeout(r, 200));
      }
      return count > 0 ? Math.round(total / count) : -1;
    }

    // Initialize UI and events
    document.addEventListener('DOMContentLoaded', async () => {
      const ipAddressEl = document.getElementById('ip-address');
      const ipCityEl = document.getElementById('ip-city');
      const ipRegionEl = document.getElementById('ip-region');
      const ipCountryEl = document.getElementById('ip-country');
      const ipIspEl = document.getElementById('ip-isp');
      const ipVpnEl = document.getElementById('ip-vpn');
      const copyIpBtn = document.getElementById('copy-ip-btn');

      const pingEl = document.getElementById('ping');
      const startPingTestBtn = document.getElementById('start-ping-test');

      // Fetch IP info
      const ipInfo = await fetchIPInfo();
      if (ipInfo) {
        ipAddressEl.textContent = ipInfo.ip || 'Unknown';
        ipCityEl.textContent = ipInfo.city || 'Unknown';
        ipRegionEl.textContent = ipInfo.region || 'Unknown';
        ipCountryEl.textContent = ipInfo.country_name || 'Unknown';
        ipIspEl.textContent = ipInfo.org || 'Unknown';

        if (
          ipInfo.privacy &&
          (ipInfo.privacy.vpn === true || ipInfo.privacy.proxy === true)
        ) {
          ipVpnEl.textContent = 'Yes (VPN / Proxy detected)';
          ipVpnEl.classList.remove('text-yellow-300');
          ipVpnEl.classList.add('text-red-400', 'font-bold');
        } else {
          ipVpnEl.textContent = 'No';
          ipVpnEl.classList.remove('text-red-400', 'font-bold');
          ipVpnEl.classList.add('text-yellow-300');
        }
      } else {
        ipAddressEl.textContent = 'Failed to fetch IP info';
        ipCityEl.textContent = '-';
        ipRegionEl.textContent = '-';
        ipCountryEl.textContent = '-';
        ipIspEl.textContent = '-';
        ipVpnEl.textContent = '-';
      }

      // Copy IP button event
      copyIpBtn.addEventListener('click', () => {
        if (ipAddressEl.textContent && ipAddressEl.textContent !== 'Loading...') {
          copyToClipboard(ipAddressEl.textContent);
        }
      });

      // Ping test button event
      startPingTestBtn.addEventListener('click', async () => {
        startPingTestBtn.disabled = true;
        startPingTestBtn.classList.add('opacity-70', 'cursor-not-allowed');
        pingEl.textContent = 'Testing...';

        const ping = await measurePing('https://1.1.1.1/cdn-cgi/trace');
        pingEl.textContent = ping >= 0 ? ping + ' ms' : 'Failed';

        startPingTestBtn.disabled = false;
        startPingTestBtn.classList.remove('opacity-70', 'cursor-not-allowed');
      });
    });
  </script>
</body>
</html>